# 실전 프로젝트

### 구성

- 요구사항 분석 및 설계에서부터 구현까지의 모든 과정
- UML을 프로젝트에서 이용하는 방법
- 프레임워크 기반의 애플리케이션 개발
- DAO와 DO패턴의 이용
- 애플리케이션 국제화
- 애플리케이션 로깅 및 예외 처리
  - #웹 컨텍스트의 모든 에러에 대해서 전역으로 에러 처리 페이지를 설정할 수 있다.
    #웹 컨텍스트의 web.xml 설정파일에 다음 요소들로 정의한다.
    <error-page>
      <error-code></error-code><!-- 404, 500 -->
      <location></location>  
      </error-page>
      <error-page>
      <exception-type>java.lang.NullPointerException</exception-type>
      <location></location>  
      </error-page>

### 진행과정

1. 요구사항 분석
   - 유스케이스 다이어그램
   - 상세 유스케이스(좀더 세부적으로)
   - 한눈에 기능을 정리한 것
2. 설계
3. 구현 Part1
   - 차별성과 비즈니스가치는 반드시 포함
4. 구현 Part2



### 게시판의 유스케이스

- 게시물 작성
  - 비밀번호 체크(include,포함기능)
  - 사진,파일 첨부(확장기능)
- 게시물 목록
- 게시물 보기--댓글(확장)
- 게시물 수정
  - 비밀번호 체크
- 게시물 삭제
  - 비밀번호 체크



- 댓글작성- 비밀번호설정)
- 댓글 수정- 비밀번호 체크
- 댓글 삭제-비밀번호 체크

### 게시글의 데이터

- 제목

- 내용

- 작성자

- 작성일

- 조회수

- 글번호

- 첨부파일여부(멀티인지여부)

- 비밀번호체크

- 페이지수

  ```
  order by 글작성일자(글번호) desc
  where -tlwkrrmfqjsgh ~ 
  ```

  

### 댓글

-  글 번호
- 게시글번호(부모키)
- 작성자
- 내용
- 비밀번호체크

###  기본게시판 만들기

##### 먼저 DB테이블설정

- 테이블 이름을 착각해서 잘못썼으니 혼자할떄는 잘해보자.

```sql
create table emaillsit(
username varchar2(20),
email varchar2(50));

insert into emaillsit values('admin','admin@korea.com');
commit;
 
 select*from emaillsit;
 
 alter table emaillsit add(no number(6));
 create sequence email_seq nocache;
 update emaillsit set no=email_seq.nextval where username='admin';
 commit;
 
 alter table emaillsit add constraint email_pk primary key(no);
 commit;
 desc emaillsit

```

##### 이클립스에서

##### EmailVO.java

```java
package lab.web.model;

public class EmailVO {
 private String username;
 private String email;
 private int no;
 
public EmailVO() {
	super();
}

public EmailVO(String username, String email,int no) {
	super();
	this.username = username;
	this.email = email;
	this.no=no;
}

public int getNo() {
	return no;
}

public void setNo(int no) {
	this.no = no;
}

public String getUsername() {
	return username;
}

public void setUsername(String username) {
	this.username = username;
}

public String getEmail() {
	return email;
}

public void setEmail(String email) {
	this.email = email;
}
 
}


```



##### EmailDAO.java를 작성

int final PAGE_SIZE=0;

//전체 게시물 수와 페이지 크기를 가지고 전체 페이지 개수 계산

//소수점에 따라 계산 상의 오류가 없도록 두 가지 중 한 가지를 이용

1.첫번째 방법

```java
	pageCount=totalCount/PAGE_SIZE:

if((totalCount % PAGE_SIZE)!=0)
pageCount++;
```

2.두번째 방법

```java
pageCount=(int)Math.ceil(totalCount/(PAGE_SIZE+0.0))
```



3.현재 페이지 그룹 설정

```java
int curGroup=(curPage-1)/GROUP_SIZE;
```

```java
package lab.web.model;

import java.io.FileInputStream;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.Properties;

import lab.web.controller.userVO;

public class EmailDAO {
	public Connection dbCon() {
		Connection con=null;
		try {
			Properties prop=new Properties();
			prop.load(new FileInputStream("C:/workspace2/web2/WebContent/WEB-INF/db.properties"));
			Class.forName(prop.getProperty("driver"));
			con =DriverManager.getConnection(prop.getProperty("url"),
			prop.getProperty("user"),prop.getProperty("pwd"));
		}catch(Exception e) {
			e.printStackTrace();
		}
		return con;
	}
		
		public void dbClose(Connection con,Statement stat, ResultSet rs) {
			try {
				if(rs!=null)rs.close();
				if(stat!=null)stat.close();
				if(con!=null)con.close();
				
			}catch(Exception e) {
				e.printStackTrace();
			}
		}
		
	
public ArrayList<EmailVO> getList(int page,int pageSize) {
	int total=0;
	
	ArrayList<EmailVO> lists=new ArrayList();
	Connection con=null;
	PreparedStatement stat=null;
	int start=(page-1)*pageSize;//4페이지의 글 목록 31~40번글번호
	int end=page*pageSize;
	String sql="select * from emaillsit where no>"+start
			+" and no <="+end+" order by no desc";//start no보다 크고 end번호이하인 페이지 출력
	
	ResultSet rs=null;
	try {
		con=dbCon();
		stat=con.prepareStatement(sql);
		rs=stat.executeQuery();
		while(rs.next()) {
			EmailVO vo=new EmailVO(rs.getString("username")
					 ,rs.getString("email")
					 ,rs.getInt("no"));
			lists.add(vo);
		}//lists에 저장한다.
		
	}catch(Exception e) {
		e.printStackTrace();
	}finally {
		dbClose(con,stat,rs);
	}
	
	return lists;
	
}
public int getTotalCount() {
	
		int total=0;
		Connection con=null;
		PreparedStatement stat=null;
		String sql="select count(*) from emaillsit";
		ResultSet rs=null;
		try {
			con=dbCon();
			stat=con.prepareStatement(sql);
			rs=stat.executeQuery();
			if(rs.next()) {
				total=rs.getInt(1);
			}
		}catch(Exception e) {
			e.printStackTrace();
		}finally {
			dbClose(con,stat,rs);
		}
		return total;
	
}

}
```



##### list-page.jsp

```java
<%@ page contentType="text/html; charset=utf-8"   %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"  %>
<%!
	int numPerPage = 10;  //페이지 그룹내에 페이지 개수
	int numPerBlock = 10;	  //페이지내에 글 개수
%>
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
table  {};
</style>
<title>list-page.jsp</title>
</head>
<body>
<h3> Email  등록 목록 </h3>
<table border=1 cellpadding=5 cellspacing=0>
<tr><td width=50>번호</td><td width=125>이름</td><td width=125>email</td></tr>

<!-- 이메일 목록 -->
<c:forEach var="vo" items="${headers}">
<tr><td width=50>${vo.no}</td>
<td>${vo.username}</td>
<td>${vo.email}</td></tr>
</c:forEach>
</table>

<!-- 페이지 번호 -->
<div style="text-align:center">	
<%	
	Integer p = (Integer) request.getAttribute("pageNo");
	int mypage = p.intValue();
	//출력될 페이지가 속한 페이지 그룹 계산
    int currentBlock = (int)Math.ceil(mypage / (double)numPerBlock);
	
	//전체 페이지 개수
	Integer tp = (Integer) request.getAttribute("totalPage");
	double totalPage = tp.intValue();
	
	//전체 페이지 블록 개수
	int totalBlock = (int)Math.ceil(totalPage / numPerBlock);
	
	if(totalBlock > currentBlock) { 
		int togo = (currentBlock + 1) * numPerBlock;
		if(togo > totalPage)
			togo = (int) totalPage; %>
		<a href=./list.do?page=<%=togo%>> <<다음 </a>
<%	}
	//현재 페이지 그룹의 페이지 번호 리스트
	for(int i = numPerBlock; i > 0; i--) {
		int pn = numPerBlock * (currentBlock-1) + i;
		if(pn > totalPage)
			continue;
		if(pn == mypage) { %>
		<a href=./list.do?page=<%=pn%>>
		<span style="text-decoration:underline"><%=pn%></span></a>&nbsp;
<%		} else { %>
		<a href=./list.do?page=<%=pn%>><%=pn%></a>&nbsp		
<%		}
	}
	if(currentBlock > 1) { %>
		<a href=./list.do?page=<%= (currentBlock-1)*numPerBlock %>> 이전>> </a>
<%	} %> </div> 
</div>
</body>
</html>   
```

##### ListAction.java

```java
package lab.web.model;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;


@WebServlet("/list.do")
public class ListAction extends HttpServlet {
	private static final long serialVersionUID = 1L;
      public static int numPerBlock=10;//상수로 지정
      public static int numPerPage=10;

    public ListAction() {
        super();
        // TODO Auto-generated constructor stub
    }


	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		response.setContentType("text/html;charset=utf-8");
		PrintWriter out=response.getWriter();
		ServletContext sc=getServletContext();
		RequestDispatcher rd=null;
		EmailDAO dao=new EmailDAO();
		ArrayList<EmailVO>headers=null;
		String page=null;
		page=request.getParameter("page");
		
		int pageNo=1;
		int pageCount=0;
		pageCount=(int)Math.ceil(dao.getTotalCount()/(double)numPerPage);
		pageCount=Math.max(pageCount, 1);
		if(page==null) {
			
			pageNo=pageCount;
			headers=dao.getList(pageNo, numPerPage);
		}else {
			pageNo=Integer.parseInt(page);
			headers=dao.getList(pageNo, numPerPage);
			
		}
		
		request.setAttribute("headers", headers);
		request.setAttribute("pageNo", new Integer(pageNo));
		request.setAttribute("totalPage", new Integer(pageCount));
		
		rd=sc.getRequestDispatcher("/list-page.jsp");
		rd.forward(request,response);
		
	}
protected void doPost(HttpServletRequest request,HttpServletResponse response) {
	
}

	

}

```



### 본격 게시판 만들기

#### DB설정

```sql
drop table bbs purge;
    
    create table bbs(
    bid number(6) primary key,
    subject varchar2(100),
    writer varchar2(20),
    password varchar2(15),
    idate date,
    contents varchar2(2000),
    email varchar2(50),
    ip varchar2(30),
    fileYN char(1) default 'N' check(fileYN in('Y','N')),
    rcount number(5) default 0,
    vcount number(5) default 0);
    
    
    
    drop sequence bbs_suq;
    create sequence bbs_seq nocache;
    
    create table bbs_comment(
    cmid number(6) primary key,
    rbid number(6),
    writer varchar2(20),
    idate date,
    contents varchar2(1000),
    password varchar2(15),
    ip varchar2(30));
    
    drop sequence comment_seq;
    create sequence comment_seq nocache;
    
   insert into bbs (bid, subject, writer, idate, contents, password, ip)
values (bbs_seq.nextval, '테스트', '게시판지기', sysdate, 
'게시판 테스트입니다', '1234', '70.12.50.130');

insert into bbs_comment (cmid, rbid, writer, idate, contents, password, ip
) values (comment_seq.nextval, -1, '관리자', sysdate, 
'댓글 테스트입니다', '1234', '70.12.50.131');
commit;

create table bbs_file(
fid number primary key,
rbid number ,
filename varchar2(50),
filetype varchar2(15));

create sequence bbsfile_seq nocache;

    


```



#### 이클립스작업

##### COmmentVO.java

```java
package lab.board.model;

import java.sql.Date;

public class CommentVO {
	private int cmid;
	private int rbid;
	private String writer;
	private Date idate;
	private String contents;
	private String password;
	private String ip;
	public CommentVO() {
		super();
	}
	public CommentVO(int cmid, int rbid, String writer, Date idate, String contents, String password, String ip) {
		super();
		this.cmid = cmid;
		this.rbid = rbid;
		this.writer = writer;
		this.idate = idate;
		this.contents = contents;
		this.password = password;
		this.ip = ip;
	}
	public int getCmid() {
		return cmid;
	}
	public void setCmid(int cmid) {
		this.cmid = cmid;
	}
	public int getRbid() {
		return rbid;
	}
	public void setRbid(int rbid) {
		this.rbid = rbid;
	}
	public String getWriter() {
		return writer;
	}
	public void setWriter(String writer) {
		this.writer = writer;
	}
	public Date getIdate() {
		return idate;
	}
	public void setIdate(Date idate) {
		this.idate = idate;
	}
	public String getContents() {
		return contents;
	}
	public void setContents(String contents) {
		this.contents = contents;
	}
	public String getPassword() {
		return password;
	}
	public void setPassword(String password) {
		this.password = password;
	}
	public String getIp() {
		return ip;
	}
	public void setIp(String ip) {
		this.ip = ip;
	}
	 
}

```

##### BbsDAO.java

```java
package lab.board.model;

import java.io.FileInputStream;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.Properties;

public class BbsDAO {
 public Connection dbCon() {
	 Connection con=null;
	 try{
		 Properties prop=new Properties();
		 prop.load(new FileInputStream("C:/workspace2/board/WebContent/WEB-INF/db.properties"));
		 Class.forName(prop.getProperty("driver"));
		 con=DriverManager.getConnection(prop.getProperty("url"),
					prop.getProperty("user"),prop.getProperty("pwd"));
				}catch(Exception e) {
					e.printStackTrace();
				}
				return con;
 }
 public void dbClose(Connection con, Statement stat,ResultSet rs) {
	 try {
		 if(rs!=null)rs.close();
		 if(stat!=null)stat.close();
		 if(con!=null)con.close();
	 }catch(Exception e) {
			e.printStackTrace();
		}
	}
 
 public int getPageCount(int numPerPage) {
	 	int total=0;
		Connection con=null;
		PreparedStatement stat=null;
		ResultSet rs=null;
		String sql="select count(*) from bbs";
		try {
			con=dbCon();
			stat=con.prepareStatement(sql);
			rs=stat.executeQuery();
			if(rs.next()) {
				total=rs.getInt(1);
			}
		}catch(Exception e) {
			e.printStackTrace();
		}finally {
			dbClose(con,stat,rs);
		}
		int pageCount=(int) Math.ceil(total/(double)numPerPage);
		pageCount=Math.max(pageCount, 1);
		return pageCount;
	
}

 
 public int insertBbs(BbsVO form) {
	  int result = 0;
      Connection con = null;
      PreparedStatement stat = null;
      String sql = "insert into bbs (bid, subject,writer,password,idate,contents,"
            + "email,ip,fileYN) values (bbs_seq.nextval,?,?,?,sysdate,?,?,?,?)";
      try {
         con = dbCon();
         stat = con.prepareStatement(sql);
         stat.setString(1, form.getSubject());
         stat.setString(2, form.getWriter());
         stat.setString(3, form.getPassword());
         stat.setString(4, form.getContents());
         stat.setString(5, form.getEmail());
         stat.setString(6, form.getIp());
         stat.setString(7, form.getFileYN());
         result = stat.executeUpdate();
      } catch (Exception e) {
         e.printStackTrace();
      } finally {
         dbClose(con,stat,null);
      }
      return result;
   }

 public ArrayList<BbsVO> getBbsList(int page,int numPerPage){
	 //페이지 번호에 해당하는  게시글 10개 검색해서 리턴
	 int total=0;
		StringBuffer sql=new StringBuffer();
		ArrayList<BbsVO> lists=new ArrayList();
		Connection con=null;
		PreparedStatement stat=null;
		int start=(page-1)*numPerPage;//4페이지의 글 목록 31~40번글번호
		int end=page*numPerPage;
		sql.append("select bid,subject,writer,idate,rcount");
		sql.append(" from bbs where bid>"+start);
		sql.append(" and bid <=" + end + " order by bid desc");
		
		ResultSet rs=null;
		try {
			con=dbCon();
			stat=con.prepareStatement(sql.toString());
			rs=stat.executeQuery();
			while(rs.next()) {
				BbsVO vo=new BbsVO();
						vo.setBid(rs.getInt("bid"));
						vo.setSubject(rs.getString("subject"));
						vo.setWriter(rs.getString("writer"));
						vo.setIdate(rs.getDate("idate"));
						vo.setRcount(rs.getInt("rcount"));
						lists.add(vo);
			}
			
			}//lists에 저장한다.
			
		catch(Exception e) {
			e.printStackTrace();
		}finally {
			dbClose(con,stat,rs);
		}
		
		return lists;
 }
 
}

```



##### BbsVO.java

```java
package lab.board.model;

import java.sql.Date;

public class BbsVO {
	private int bid;
	private String subject;
	private String writer;
	private String password;
	private Date idate;
	private String contents;
	private String email;
	private String ip;
	private String fileYN;
	private int rcount;
	private int vcount;
	public BbsVO() {
		super();
	}
	
	public Date getIdate() {
		return idate;
	}

	public void setIdate(Date idate) {
		this.idate = idate;
	}

	public BbsVO(int bid, String subject, String writer, String password, Date idate, String contents, String email,
			String ip, String fileYN, int rcount, int vcount) {
		super();
		this.bid = bid;
		this.subject = subject;
		this.writer = writer;
		this.password = password;
		this.idate = idate;
		this.contents = contents;
		this.email = email;
		this.ip = ip;
		this.fileYN = fileYN;
		this.rcount = rcount;
		this.vcount = vcount;
	}

	public int getBid() {
		return bid;
	}
	public void setBid(int bid) {
		this.bid = bid;
	}
	public String getSubject() {
		return subject;
	}
	public void setSubject(String subject) {
		this.subject = subject;
	}
	public String getWriter() {
		return writer;
	}
	public void setWriter(String writer) {
		this.writer = writer;
	}
	public String getPassword() {
		return password;
	}
	public void setPassword(String password) {
		this.password = password;
	}
	
	public String getContents() {
		return contents;
	}
	public void setContents(String contents) {
		this.contents = contents;
	}
	public String getEmail() {
		return email;
	}
	public void setEmail(String email) {
		this.email = email;
	}
	public String getIp() {
		return ip;
	}
	public void setIp(String ip) {
		this.ip = ip;
	}
	public String getFileYN() {
		return fileYN;
	}
	public void setFileYN(String fileYN) {
		this.fileYN = fileYN;
	}
	public int getRcount() {
		return rcount;
	}
	public void setRcount(int rcount) {
		this.rcount = rcount;
	}
	public int getVcount() {
		return vcount;
	}
	public void setVcount(int vcount) {
		this.vcount = vcount;
	}
//	@Override
//	public String toString() {
//		
//		return "BbsVO [bid=" +bid+ ",subject=" + subject + 
//				",writer="+writer+
//				",password="+password+
//				", idate="+idate+
//				", contents="+contents+
//				",email="+email+",ip="
//				+ip+",fileYN="+fileYN+
//				",rcount="+rcount+",vcount="+vcount+"]";
//	}
}

```



##### FileInfoVO.java

```java
package lab.board.model;

public class FileInfoVO {
	private int fid;
	private int rbid;
	private String filename;
	private String filetype;
	public FileInfoVO() {
		super();
	}
	public FileInfoVO(int fid, int rbid, String filename, String filetype) {
		super();
		this.fid = fid;
		this.rbid = rbid;
		this.filename = filename;
		this.filetype = filetype;
	}
	@Override
	public String toString() {
		
		return "FileInfoVO [fid="+fid+", rbid="+rbid+",filename="+filename+", filetype="+filetype+"]";
	}
	public int getFid() {
		return fid;
	}
	public void setFid(int fid) {
		this.fid = fid;
	}
	public int getRbid() {
		return rbid;
	}
	public void setRbid(int rbid) {
		this.rbid = rbid;
	}
	public String getFilename() {
		return filename;
	}
	public void setFilename(String filename) {
		this.filename = filename;
	}
	public String getFiletype() {
		return filetype;
	}
	public void setFiletype(String filetype) {
		this.filetype = filetype;
	}
	
	
}

```



##### bbs_list.jsp

```jsp

<%@page import="java.util.Vector"%> 
<%@ page contentType="text/html;charset=utf-8" %> 
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%!
	//int numPerPage = BbsListAction.numPerPage;
	//int numPerBlock = BbsListAction.numPerBlock;
	int numPerPage = 10;
	int numPerBlock = 10;
	 
%>
<html><head><title>게시판</title>
<script>
 
</script>
</head>
<link href="mystyle.css" rel="stylesheet" type="text/css">
<body><h3 id="header">게시판</h3>

<div id='menu'>
<%@ include file="mymenu.jsp" %>
</div>

<div id="main">
<table width=100%>
	<tr><th>번호</th><th>제목</th><th>작성자</th>
		<th>작성일</th><th>조회수</th></tr>
<c:forEach var="row" items="${headers}">
	<tr><td colspan=5 height=1 background=./image/dotline.gif></td></tr>
	<tr><td>${row.bid} </td><td>		 
		<a href="">${row.subject}</a>
		</td>
		<td>${row.writer}</td>
		<td>${row.idate}</td>
		<td style='text-align:right'>${row.rcount}</td>
		<!-- 답글 -->
 
</c:forEach>
<tr><td colspan=5 height=1 background=./image/dotline.gif></td></tr>
</table>
<div style='text-align:right'><br><br>
	<a href=./write.do>글작성</a>
</div>
<!-- 페이지 번호 -->
	<div style="text-align:center">	
<%	
	Integer p = (Integer) request.getAttribute("pageNo");
	int mypage = p.intValue();
    int currentBlock = (int)Math.ceil(mypage / (double)numPerBlock);
	Integer tp = (Integer) request.getAttribute("totalPage");
	double totalPage = tp.intValue();
	int totalBlock = (int)Math.ceil(totalPage / numPerBlock);
	if(totalBlock > currentBlock) { 
		int togo = (currentBlock + 1) * numPerBlock;
		if(togo > totalPage)
			togo = (int) totalPage; %>
		<a href=./list.do?page=<%=togo%>> << </a>
<%	}
	for(int i = numPerBlock; i > 0; i--) {
		int pn = numPerBlock * (currentBlock-1) + i;
		if(pn > totalPage)
			continue;
		if(pn == mypage) { %>
		<a href=./list.do?page=<%=pn%>>
		<span style="text-decoration:underline"><%=pn%></span></a>&nbsp;
<%		} else { %>
		<a href=./list.do?page=<%=pn%>><%=pn%></a>&nbsp		
<%		}
	}
	if(currentBlock > 1) { %>
		<a href=./list.do?page=<%= (currentBlock-1)*numPerBlock %>> >> </a>
<%	} %> </div> 
</div>

</body>
</html>
```



##### bbs_write.jsp

```jsp
<%@ page language="java" contentType="text/html;charset=utf-8" %> 



<!DOCTYPE html>
<html><head><title>게시판 글 작성</title></head>
<link href="mystyle.css" rel="stylesheet" type="text/css">
<body><h3 id="header">게시판 글 작성</h3>

<form method='post' action='./write.do'>
<table width='100%'>
 
<tr><td>제목</td><td><input type='text' name='subject' size="50"></td></tr>

	<tr><td>이름</td>
		<td><input type='text' name='writer'  ></td></tr>
	<tr><td>암호</td>
		<td><input type='password' name='password' ></td></tr>
	<tr><td>Email</td>
		<td><input type='text' name='email' size="50"></td></tr>
	


<tr><td>내용</td><td>
<textarea cols='65' name='contents' rows='20'></textarea>
</td></tr>


 
 
<tr><td>파일 첨부 </td>
		<td><input type='file' name='upload' multi></td></tr>
 	
<tr><td colspan='2' align='center'>
<a href="./list.do">글록록</a>
<input type='submit' value="글쓰기 저장" > 
<input type='reset' value="글쓰기 취소" >
</td></tr>
</table>
</form>



</body>
</html>

```



##### mymenu.jsp

```jsp
<%@ page contentType="text/html;charset=utf-8" %>
<div id="menucontainer">
	<div id="shatop"></div>
	<h3 class="center">메 뉴</h3>
	<a href=logout.jsp>로그아웃</a>
	<div class="blank">&nbsp;</div>
	<a href=viewuser.jsp>정보수정</a>
	<div class="blank">&nbsp;</div>
	<a href=notice.jsp>공지사항</a>
	<div class="blank">&nbsp;</div>
	<a href=user_list.jsp>회원목록</a>
	<div class="blank">&nbsp;</div>
	<a href=cabinet.jsp>문서관리</a>
	<div class="blank">&nbsp;</div>	
	<a href=Mail>전자메일</a>
	<div class="blank">&nbsp;</div>
	<a href=bbs.do>게 시 판</a>
	<div class="blank">&nbsp;</div>
	<div class="blank">&nbsp;</div>		
	<h3 class="center">방문자</h3>
	<div class="blank">&nbsp;</div>
	<div class="blank">&nbsp;</div>		
	
	</div>
</div>
```



##### mystyle.css

```jsp
body { 
	margin-top: 0;
	margin-bottom: 0;
	margin-left: 0;
	margin-right: 0;
	padding-left: 0;
	padding-right: 0;
	background-color:#ececec;
}

.center {
	text-align: center
}

.line {
	font-size : x-small;
	font-family: 굴림, arial, "lucida console", sans-serif;
	text-align : center;
}
/*
a { 
	text-decoration:none;
	color:#C9CA6D;
}

a:hover {
	color:#757678;
	text-decoration:underline;
}
*/
#header {
	margin: 5px;
	padding: 5px;
	height: 200px;
	background-image: url('image/back.jpg');
	text-align: center;
	font-weight: bolder;
}

#menu {
	position: absolute;
	left: 5px;
	top: 220px;
	width: 100px;  	
	padding-left: 5;
	padding-right: 5;
	background:#fff;
	border-right:1px #ececec solid;
	border-left:1px #ececec solid;	
}

#menucontainer {
	border-right:1px #ececec solid;
	border-left:1px #ececec solid;
}

#menu a {
	display:block;
	text-decoration:none;
	color:#87ACBB;
	padding-left:5px;
	width:100px;
	background:#fff;
}

#menu a:hover {
	color:#fff;
	background:#C3D3E2;
}

#menu h3 {
	display:block;
	width:100px;
	color: #fff;
	background:#A26B6B;
	border-right:3px solid #A26B6B;
	font-weight: bolder;	
}

#main {
	top: 0;
	padding: 5px;
	height: 100%;
	margin-left: 125px;
	margin-right: 5px;
	background:#fff ;
	border:1px #bcbcbc solid;
}

#shabottom {
	float:right;
	background:transparent url(image/shabottom.gif) bottom no-repeat;
	margin:auto;
	padding:0;
	height:5px;
	width:100px;
	font:1px/5px "Georgia",serif;
}

#shatop {
	background:transparent url(image/shatop.gif) top no-repeat;
	margin:0;
	padding:0;
	width:100px;
	height:5px;
	font:1px/5px "Georgia",serif;
	float:right;
}

.blank {
	clear:both;
	float:none;
	font-size:10px;
	color:#FFF;
}

.button {
	width: 100px;
	text-align:center;
	text-decoration:none;
	padding-top: 2;
	padding-bottom: 2;
	padding-left: 5;
	padding-right: 5;
	background: #ececec;
	border-top:1px #ececec solid;
	border-bottom:1px #acacac solid;
	border-right:1px #acacac solid;
	border-left:1px #ececec solid;	
}
```



##### simple.css

```jsp
h1, h2, h3 {
	text-align: center
}
/*
a:hover {
	background:#C3D3E2;
}
*/
#header {
	background-image:url(image/bgWood.jpg);
    text-align: center;
	font-weight: bolder;
}
#menu {
	border : 1px #ececec dotted
}
#main {
	padding-top : 10px;
	border-top : 1px #AAA solid	
}
.blank {
	display: none;
}
```

##### BoardAction.java

```java
package lab.board.controller;

import java.io.File;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.Collection;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.MultipartConfig;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.Part;

import lab.board.model.BbsDAO;
import lab.board.model.BbsVO;
import lab.board.model.FileInfoVO;


@WebServlet("/write.do")

public class BoardAction extends HttpServlet {
	private static final long serialVersionUID = 1L;
      public static int numPerBlock=10;
      public static int numPerPage=10;
  
    public BoardAction() {
        super();
        // TODO Auto-generated constructor stub
    }

	
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		response.setContentType("text/html;charset=utf-8");
	    
		response.sendRedirect("./bbs_write.jsp");

	}


	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	 response.setCharacterEncoding("text/html;charset=utf-8");
	 request.setCharacterEncoding("utf-8");
	 PrintWriter out=response.getWriter();
	 BbsDAO dao= new BbsDAO();
	 BbsVO form=null;
	 String page=null;
	 page=request.getParameter("page");
	 form=new BbsVO();
	 String fileFlag="N";
	 if(request.getParameter("upload")!=null){
		 fileFlag="Y";
		 //upload된 파일 저장 처리
	 }
	 form.setFileYN(fileFlag);
	 form.setWriter(request.getParameter("writer"));
	 form.setPassword(request.getParameter("password"));
	 form.setSubject(request.getParameter("subject"));
	 form.setEmail(request.getParameter(("email")));
	 form.setEmail(request.getParameter("contents"));
	 form.setContents(request.getRemoteAddr());
	 if(dao.insertBbs(form)>0) {
		 response.sendRedirect("./list.do");
	 }
	}
//	public void uploadProc(HttpServletRequest request,HttpServletResponse response) throws ServletException, IOException {
//	BbsDAO dao=new BbsDAO();
//	String path="c:uploadtest";
//	File isDir=new File(path);
//	String saveFile=null;
//	if(!isDir.isDirectory()) {
//		isDir.mkdirs();
//	}
//	Collection<Part> parts =request.getParts();
//	for(Part part: parts) {
//		if(part.getContentType()!=null) {
//			String fileName=part.getSubmittedFileName();
//			if(fileName!=null) {
//				saveFile=fileName.substring(0,fileName.lastIndexOf("."))
//						+"_"+System.currentTimeMillis()+fileName.substring(fileName.lastIndexOf("."));
//				
//				part.write(saveFile);
//				
//				System.out.println("file저장");
//				FileInfoVO file=new FileInfoVO();
//				//file.setRbid();
//				file.setFilename(saveFile);
//				String fileType=fileName.substring(fileName.lastIndexOf("."));
//				
//				file.setFiletype(fileType);
//				//dao.insertUploadFile(file);
//				
//					
//				
//			}
//		}
//	}
//	}

}

```

##### listAction.java

```java
package lab.board.controller;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import lab.board.model.BbsDAO;
import lab.board.model.BbsVO;


@WebServlet("/list.do")
public class ListAction extends HttpServlet {
	private static final long serialVersionUID = 1L;
      public static int numPerBlock=10;//상수로 지정
      public static int numPerPage=10;

    public ListAction() {
        super();
        // TODO Auto-generated constructor stub
    }


	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		request.setCharacterEncoding("utf-8");
		response.setContentType("text/html;charset=utf-8");
		doPost(request,response);
		
		
		
		
	}
protected void doPost(HttpServletRequest request,HttpServletResponse response) throws ServletException,IOException {
	response.setContentType("text/html/charset=utf-8");
	request.setCharacterEncoding("utf-8");
	
	ServletContext sc=getServletContext();
	RequestDispatcher rd= null;
	BbsDAO dao=new BbsDAO();
	ArrayList<BbsVO> headers=null;
	String page=null;
	page=request.getParameter("page");
	int pageNo=1;
	if(page==null) {
		pageNo=dao.getPageCount(numPerPage);
		headers=dao.getBbsList(pageNo,numPerPage);
	}else {
		pageNo=Integer.parseInt(page);
		headers=dao.getBbsList(pageNo,numPerPage);
	}
	Integer totalPage=new Integer(dao.getPageCount(numPerPage));
	request.setAttribute("headers", headers);
	request.setAttribute("pageNo", new Integer(pageNo));
	request.setAttribute("totalPage", totalPage);
	rd=sc.getRequestDispatcher("/bbs_list.jsp");
	rd.forward(request, response);
	
}

	

}

```











